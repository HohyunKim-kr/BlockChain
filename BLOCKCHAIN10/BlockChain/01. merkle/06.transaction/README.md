# 지갑 구성 및 지갑의 역활

- 기본적으로 암호화폐를 안전하게 보관할수 있고. 암호화폐를 전달하거나 받을수 있다.
- 자신의 소유권을 암호화 방식으로 증명 지갑의 개인키를 사용해서 거래의 서명을 검증하고 본인의 자산을 관리
- 본인의 암호화폐의 보유량도 확인
- 지갑의 거래내역 확인
- 복구 문구를 사용해서 지갑 복원(복구 문구를 가지고 특정 알고리즘을 거쳐서 개인키를 추출한다.)

## 금융

- 금융 쪽에서는 장부를 가지고 모든 거래내용을 기록하는 방식

## 분산 원장

- 분산원장은 금융과 반대로 거래에 참여하는 모든 참여자가 장부를 가지고 있고
- 거래가 발생했을때 해당 거래내역을 각자의 장부에 기록하는 방식
- 중앙에서 관리하는게 아닌 모두 장부를 가지고 비교하여 하나의 장부로 유지시킨다.

# 신원 인증 방식 분산 원장 기술 개인키, 공개키, 서명(영수증)

## 암호화 방식

- 대칭형 : 암호화 복호화 할때 사용하는 키가 동일한 한개의 키를 사용한다. 암호화를 시킨 사람과 수신된 사람이 같은 키를 사용한다.

- 비대칭형 : 사용하는 키와 검증할때 사용하는 키가 다른것 키가 두개
  다른 사람에게 공개되어서는 절때 안되는 키 (비밀키) 비밀키를 토대로 만든 공개키가 한쌍

## 대칭형

- 나 -> 원본 -> 대칭키로 원본 암호화 -> 암호문
- 상대방 -> 암호문 -> 대칭키로 복호화 -> 해석된 평문
- 대칭형의 형태는 암호문을 대칭키로 가지고 있는 사람 누구나 수신 가능하다.

## 비대칭형

- 비대칭형의 경우는 암호화 할때 공개키로 확인
- 나 -> 원본 -> 개인키로 암호화 -> 공개키, 암호문
- 상대방 -> 암호문, 공개키로 확인 -> 내용 검증

## 비밀키와 공개키의 역활

- 공개키 : 상대방에게 공개하는 키
- 비밀키 : 본인만 알고있어야하는 키 암호문을 검증할때 사용

- 비밀키 소유자는 비밀키로 데이터를 암호화하고 공개키를 같이 전달
- 공개키로 암호문을 받은사람이 공개키를 가지고 검증을 할수있다.
- 공개키 데이터를 검증하는 목적은 데이터를 제공한 사람이 맞는지 신원을 보장 해주기 위한것.

## 개인키

- 실제 블록체인 네트워크에 개인키를 생성하는 방식은 2진수로 랜덤값을 64자리의 16 진수의 값으로 만든게 개인키
- 개인키가 겹칠수 있는데 거의 불가능한 경우의 수 라고 알고있으면 된다. 천문학적으로 낮다 확율이

# 순서

1. 암호화 하고 싶은 데이터를 SHA256방식의 해싱을 하고
2. 개인키를 사용해서 해시값으로 서명을 생성
3. 서명이랑 공개키는 제3 자에게 전달 되고
4. 받은 제 3자는 공개키를 이용해서 서명을 검증.

# 개인키 공개키 한쌍의 키를 생성할때 ECC 타원 곡선을 사용

- 타원 곡선 수학 개념을 가지고 디지털 서명을 보호하기 위해서 사용하는 암호화 기술
- 공개키와 개인키의 개념을 가지고 공개키는 암호화 검증을 하고 개인키로 복호화 서명을 만들때 사용하는 개념

- 기준점이 있고 기준점에서 개인키를 가지고 공개키를 구하는데 기준점과 공개키를 생성할수 있고 역산이 힘들다.

# secp256k1 알고리즘 비트코인과 이더리움에서 사용

- 타원 곡선 알고리즘
- 모든 사람들이 공통적으로 하나의 기준점을 알고있어야하고
- 타원 곡선에서 기준점 G

- 기준점의 좌표가 어딘지에 따라서 타원곡선의 별명을 붙여준다.
- y^2 = x^3 + ax + b
- 이 방정식을 만족하는 곡선
- a가 0, b가 7 기준점 G는 x 및 y좌표를 16진수로 표현한것.

- r, s, v
- r 서명 : 1 ~ n -1 까지의 정수 범위(펜을 하나 가지고) == k \* G(기준점)
- s 서명 : 서명 r로 만든 서명 (k⁻¹ = (z + r _ private key) mod n) k를 역수 계산 z + r _ 개인키 나머지 n
- v 복구문
- z 트랜잭션 내용
- w 동일한 서명을 만들지 nonce 값을 주자.
- 공식보단 서명 s를 만드는데 개인키를 사용한다는 개념

1. 트랜잭션 발생
2. 개인키로 서명 생성
3. 서명 r, 서명 s, v 생성

4. 수신 서명을 검증 하고 트랜잭션 블록에 기록

```sh
# 타원 곡선 알고리즘 패키지 설치
npm i elliptic @types/elliptic
```
 
 # 지갑을 구현해보자
 # 1. 지갑의 내용을 elliptic패키지를 가지고 공개키, 개인키를 만들고
 # 2. 파일을 생성해서 개인키를 내용으로 넣어주고 파일의 이름은 공개키로 만들어 보자.
 