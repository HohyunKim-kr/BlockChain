# blockchain 비트코인

- 블록이라고하는 객체 데이터들이 P2P 방식 기반으로 생성된 체인의 형태의 연결고리 기반의 분산데이터 저장환경에 저장해서
  누구든 임의로 수정할 수 없고 누구나 변경의 결과를 조회할 수 있는 분산 컴퓨팅 기술기반의 원장관리 기술

## block 이란?

- 다수의 트랜잭션을 하나로 관리하기 위한 객체
- 위에서 말하는 소규모 데이터는 트랜잭션과 블록의 기본 내용이 포함된다.
- 트랜잭션은 간단히 말해서 거래 정보
- 송금이나 등등 거래가 이루어지면 그 정보를 기록한다.

### 트랜잭션

- 업무 최소 형태
- 누군가에게 돈을 보냈다는걸 서명과 함께 블록에 기록

### p2p

- peer to peer 방식
- 중앙 집중식 관리 시스템이 아닌 컴퓨터 간의 직접 연결을 통해 정보를 주고 받음.
- 서로가 서로에게 클라이언트 이며 서버이다.

### 원장 관리

- 원장이란 원본 장부 , 거래에 대한 정보를 기록한 원본 문서
- 원장 관리란 거래에 대한 기록을 관리하느 기술을 말한다.

### 개인대 개인 거래

- 개인 대 개인 버전 전자 화폐는 금융기관을 거치지 않고는 누군가 다른 누군가에게 직접 돈을 전달하는 온라인 결제를 실현한다.
  (우리가 사용하고 있는 금융시스템은 금융기관을 통해서만 누군가 다른 누군가에게 돈을 온라인으로 보낼 수 있었음. )
- 직접 전달하는 방식이 오프라인 방식 뿐이 었고.. 현금을 지급해야함.
- 온라인 같은 경우는 개인과 개인 거래가 성립되지 않는다.
- 비트코인 어떤 중앙 기관 없이 내가 가진 자산을 다른 사람에게 직접 전달하자 라는 개념을 제안

### 개인 대 개인 거래의 문제점 해결

- 이중 지불을 막기위해 신뢰 할 수 있는 제 3자가 필요했고, 이중 지불의 문제를 해결하기 위해 중앙기관 없이 이중지불을 막기위해 블록의 생성시간을 기록하고 거래 내용을 해싱해서 해시 기반의 작업증명을 연결한 사슬로 만들어서 작업 증명을 재수행하지 않으면 변경할 수 없는 기록을 만든다.

### 가장 긴 사슬(longest chain)

- 개인 대 개인간의 네트워크이고 중앙기관없이 체인이 여러개로 나누어 질텐데 가장 긴 체인을 선택해서 하나의 체인을 유지할 수 있도록 기반을 만든 것. (간단히 검증된 블록들을 가지고 제일 긴 체인을 가지고 있는 사람이 정답이다)

### 블록체인 4대 기술요소

- 트랜잭션은 사용자의 송금 내역이 있고, 송금 내용을 하는의 블록에 포함시켜야지만 안정성을 보장할 수 있는 기반을 만들었다.
  (블록에 담긴 트랜잭션이 안정성을 보장할 수 있는 데이터라는 뜻)(POW, POS, POA)

### 2. 분산 네트워크

- 사용자가 언제든 원할 때 네트워크에 참여하고 나갈 수 있는 것

### 3. 암호화

- 거래가 위변조 되지 않았다는 것을 증명

### 4. 합의 알고리즘

- 분산 네트워크에서 중앙화 기관이 없으니까 ... 하나의 체인을 구성하는 것이 매우 중요!!! 분산화된 네트워크에서 모든 사용자들이 납득 할 수 있는 하나의 거래 장부를 만들어 주는 것이 합의 알고리즘.

### 블록의 구성

- 블록은 특정 정보를 담아놓은 객체라고 보시면 됩니다.
- 블록을 생성할 때 Header 와 Body를 나눠서 생성 블록의 이해도를 높이기 위해서 Header Body 라고 구분해 놓았다.

### 블록의 헤더

- 버젼 정보
- 이전 블록 해시
- 블록의 높이 (몇번째 블록인지, 배열의 index )
- 블록의 생성 시간 정보 (타임스탬프)
- 블록의 해시
- 블록의 Body의 내용을 해싱한 (머클루트) 하나의 해시 값이 남을 때 까지 더하고 해싱 작업을 반복
  거래를 위변조 할 수 없게 하기 위해 하나의 값만 변경되더라고 이 블록은 머클루트가 변하고 통과하지 못한다.이후의 모든 블록들이 연결이 끊긴다.
- 블록의 난이도 컴퓨터가 조건에 충족하는 값을 구할 때 까지 연산 정확 값을 찾으면 블록 채굴 성공 앞부터 0 의 갯수가 5개 이상이면 퀴즈를 풀었고 블록의 생성 권한을 얻는다.
- 논스 블록을 채굴하기 위해서 몇번이나 연산을 시도했냐의 값

### 블록의 Body

- 블록에 저장된 데이터 (트랜잭션의 내용 )

### --- -

### 작업증명 proof of work란?

- 비트코인 연산 작업 기반의 합의 알고리즘(최초의 합의 알고리즘)
- 새로운 블록을 븝록체인에 추가하려면 난이도에 맞는 값을 찾는 퀴즈를 반복해서 조건에 맞는 정답을 찾으면 작업을 완료했다는 의미 블록을 생성권한을 얻는다.
- 높은 에너지 소비 환경오염 문제점

### 지분증명 proof of stake

- 담보 같은 느낌 보상을 받기위해서 암호화 토큰을 스테이킹(예치)하고 예치한 량에 비례한 퍼센트로 확률적으로 채굴의 권한을 얻는다.
- 비잔틴 결함의 이론적인 위협은 있다 팀을 구성해서 네트워크를 방해하는 경우
- 환경친화적 전력소비를ㄹ 줄일 수 있다.

### 권위 증명 (proof of Authority)

- 귄위 증명 방식 기관에서 사용할 노드를 증명해서 이틀간에 합의를 이루는 방식 두나무 블록ㅊ에인 서비스 DBS 는 권위 증명 사용.
- 네트워크에 참여한 멤버들에게 네트워크 운영에 참여할 권리를 주고 전원이 해당 권한을 위임에 투표를 진행한다.

### 블록체인의 거래정보 변경이 불가능한 이유

- 블록의 머클루트 계산에 이전 블록의 해시가 포함되어 있기 때문에 하나의 블록의 내용이 변경되면 다음 블록의 해시가 이전 블록의 해시와 맞지 않기 때문에 블록의 연결이 끊김..
- 거래 정보 변경 -> 머클루트가 변경이 되면 -> 머클루트 변경의 해시가 변경되어 롱기스트 체인룰의 검증이 되지 않는다.
- 쉽게 말해서 블록의 거래 정보를 변경하기 위해서 거래정보를 변경한 블록부터 제일 긴 체인의 길이를 따라잡아야하고, 이말은 즉, 이후의 블록을 다 채굴해야하기 때문에 현실적으로 컴퓨팅 연산속도로 불가능하다. 현심점으로 불가능하다.

```javascript
const block = {
    version : "1.0.0",
    height : 0,
    timestamp : Date.now(),
    previousHash : "0".repeat() // 64자리 0 의값.
    hash : "0",.repeat(64),
    merkleRoot : "0".repeat(64),
    nonce : 0,
    difficulty : 0,
    data :["The Times 03/Jan/2009 Chancellor on brink of second bailout for banks"]
}



```
